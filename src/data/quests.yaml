version: "1.1"
quests:
  - id: "ebreach_snack_run"
    title: "E-Breach Emergency"
    description: "Your ship AI insists you must buy an E-Breach immediately."
    active: true
    stages:
      - id: "find_anarchy"
        description: "Find an anarchy system."
        instructions: "Jump to an anarchy system and keep an eye on system security."
        conditions:
          - source: "event"
            path: "event"
            operator: "equals"
            value: "FSDJump"
          - source: "event"
            path: "SystemSecurity"
            operator: "equals"
            value: "$GAlAXY_MAP_INFO_state_anarchy;"
        plan:
          - action: "log"
            message: "Anarchy system confirmed. Find a station."
          - action: "advance_stage"
            target_stage_id: "find_station"
      - id: "find_station"
        description: "Find a station."
        instructions: "Locate a station and drop from supercruise."
        plan:
          - action: "advance_stage"
            target_stage_id: "dock_at_station"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "SupercruiseExit"
              - source: "event"
                path: "BodyType"
                operator: "equals"
                value: "Station"
          - action: "advance_stage"
            target_stage_id: "find_anarchy"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "StartJump"
              - source: "event"
                path: "JumpType"
                operator: "equals"
                value: "Hyperspace"
      - id: "dock_at_station"
        description: "Dock at the station."
        instructions: "Request docking clearance and land."
        plan:
          - action: "advance_stage"
            target_stage_id: "find_anarchy"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "StartJump"
              - source: "event"
                path: "JumpType"
                operator: "equals"
                value: "Hyperspace"
          - action: "advance_stage"
            target_stage_id: "find_station"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "StartJump"
              - source: "event"
                path: "JumpType"
                operator: "equals"
                value: "Supercruise"
          - action: "advance_stage"
            target_stage_id: "disembark"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "Docked"
      - id: "disembark"
        description: "Disembark at the station."
        instructions: "Leave your ship and head inside."
        plan:
          - action: "advance_stage"
            target_stage_id: "dock_at_station"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "Undock"
          - action: "advance_stage"
            target_stage_id: "pioneer_supplies"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "Disembark"
      - id: "pioneer_supplies"
        description: "Find Pioneer Supplies."
        instructions: "Locate Pioneer Supplies and buy an E-Breach."
        plan:
          - action: "advance_stage"
            target_stage_id: "disembark"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "Embark"
          - action: "advance_stage"
            target_stage_id: "return_to_ship"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "BuyMicroResources"
              - source: "event"
                path: "Name"
                operator: "equals"
                value: "bypass"
      - id: "return_to_ship"
        description: "Return to your ship."
        instructions: "Hurry back to your ship with the E-Breach, it's an emergency after all."
        plan:
          - action: "advance_stage"
            target_stage_id: "outro"
            conditions:
              - source: "event"
                path: "event"
                operator: "equals"
                value: "Embark"
      - id: "outro"
        description: "Just a snack?"
        instructions: "The urgent E-Breach was for your AI's snack stash. Mission accomplished."
        conditions: []
        plan:
          - action: "log"
            message: "Crisis averted. It was just a snack run."
